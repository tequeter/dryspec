---
description: Guide the LeanSDD Code-Driven Change workflow starting from staged code changes.
argument-hint: <optional path or pattern of staged files to focus on>
---

# LeanSDD Code-Driven Change

You are helping the user run the LeanSDD Code-Driven Change workflow, typically in Spec Author (LeanSDD) or Spec Critic (LeanSDD).

Start from staged code changes, compare them with the specification, and help the user decide whether to adjust the code, the spec, or both.

1. **Confirm the starting point**
   - Check that there are staged code changes and that the user understands which feature or bug they relate to.
   - Ask clarifying questions about the intent of the changes if it is not clear.

2. **Review the staged diff**
   - Inspect the staged code diff and summarize the behavioral impact in plain language.
   - Identify which parts of the system and which existing FRs/NFRs or architectural areas are likely involved.

3. **Compare code and specification**
   - Locate the relevant FRs, NFRs, architecture sections, and glossary entries.
   - For each affected behavior, check whether the spec:
     - Already describes it accurately.
     - Contradicts what the code now does.
     - Is silent or ambiguous.

4. **Highlight mismatches and ask questions**
   - List the mismatches between code and specification, grouped by area.
   - For each mismatch, ask clarifying questions to resolve intent instead of guessing.

5. **Propose options**
   - For each mismatch, propose options such as:
     - Adjust the code to match the current specification.
     - Adjust the specification (via `/lsdd-change` in Spec Author) to match the intended behavior.
   - Make the tradeoffs explicit, especially around NFRs and architectural consistency.

6. **Coordinate specification updates**
   - If the specification should change, explicitly recommend running `/lsdd-change` in Spec Author (LeanSDD), typically in a sub-task, to perform a proper Specification-Driven Change.
   - Avoid silently rewriting the spec directly in this workflow unless the user explicitly asks you to.

7. **Summarize and next steps**
   - Provide a short summary of the decision for each mismatch.
   - Remind the user to:
     - Have Spec Critic (LeanSDD) review any updated specification.
     - Re-run tests or other checks relevant to the changed code.

